<!DOCTYPE html>
<html lang="ru">
<head>
	<title>WannaCry ransomware attack</title>
	<meta charset="utf-8">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<script>
		'use strict';

		const gcd = (a, b) => (b === 0) ? a : gcd(b, a % b);
		const w = screen.width;
		const h = screen.height;
		const r = gcd(w, h);

		console.log(`${w}x${h}`);
		let aspect = `${w / r}x${h / r}`;
		console.log(aspect);

		const ratios = ['8x5', '4x3', '6x5', '5x3', '5x4', '16x9'];
		if (!ratios.includes(aspect)) {
			aspect = ratios[0];
		}

		document.write(`<link rel="stylesheet" href="lib/shower/themes/technopark/styles/screen-${'16x9'}.css">`);

	</script>

	<link rel="stylesheet" href="lib/hljs/styles/github.css">


</head>
<body class="shower list">

	<header class="caption">
		<h1>WannaCry ransomware attack</h1>
		<p>МГТУ, кафедра ИУ8, 2017 г.</p>
	</header>

	<section class="slide">
		<h2 class="shout">
			<span style="font-size: 90%;"><strong>WannaCry</strong> ransomware attack</span>
		</h2>
	</section>

	<section class="slide question">
		<h2><strong><em>ransomware</em> attack</strong> &mdash; атака вымогателей</h2>
	</section>

	<section class="slide question">
		<h2><strong>150+</strong> стран</h2>
	</section>

	<section class="slide question">
		<h2><strong>300 000 +</strong> компьютеров</h2>
	</section>

	<section class="slide question">
		<div style="position:relative;width: 100%;height: 100%;margin: 0 auto;">
			<img class="place" src="total.png" style="transform-origin: center;transform: translate(-50%,-10%) scale(1.7);">
		</div>
	</section>

	<section class="slide question">
		<h2>Friday, May 12<br>8:24 a.m. UTC</h2>
	</section>

	<section class="slide question">
		<h2><strong><em>Timeline</em> of attack </strong></h2>
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>2010&ndash;2013</em></strong><br>
			<div style="font-size: 60%; line-height: 1.2; margin-top: 20px;">
				ЦРУ разрабатывают <em>EthernalBlue</em> &mdash; шпионскую утилиту для использования уязвимостей ОС MS Windows XP
			</div>
		</span></h2>
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>April, 2014</em></strong><br>
			<div style="font-size: 60%; line-height: 1.2; margin-top: 20px;">
				Microsoft завершает поддержку Windows XP
			</div>
		</span></h2>
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>2016</em></strong><br>
			<div style="font-size: 60%; line-height: 1.2; margin-top: 20px;">
				Хакерская группа <em>Shadow Brokers</em> крадёт EthernalBlue с серверов ЦРУ
			</div>
		</span></h2>
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>Aug&ndash;Oct, 2016</em></strong><br>
			<div style="font-size: 60%; line-height: 1.2; margin-top: 20px;">
				Shadow Brokers модифицируют EthernalBlue и создают <em>WannaCry</em>
			</div>
		</span></h2>
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>February 03, 2017</em></strong><br>
			<div style="font-size: 48%; line-height: 1.2; margin-top: 20px;">
				<em>CERT Coordination Center (CERT/CC)</em> публикуют информацию об уязвимости в Server Message Block (SMB), присутствующей в Microsoft Windows &mdash; <a
					href="https://www.us-cert.gov/ncas/current-activity/2017/02/03/CERTCC-Reports-Microsoft-SMB-Vulnerability"
					target="_blank" style="color: darkblue;">link</a>
			</div>
		</span></h2>
		<!--https://www.us-cert.gov/ncas/current-activity/2017/01/16/SMB-Security-Best-Practices-->
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>March 14, 2017</em></strong><br>
			<div style="font-size: 60%; line-height: 1.2; margin-top: 20px;">
				Microsoft публикуют патч CVE-2017-0144 (только для поддерживаемых версий Windows)
			</div>
		</span></h2>
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>April 14, 2017</em></strong><br>
			<div style="font-size: 60%; line-height: 1.2; margin-top: 20px;">
				Shadow Brokers публикуют код эксплойта EthernalBlue
			</div>
		</span></h2>
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>May 12, Morning</em></strong><br>
			<div style="font-size: 70%; line-height: 1.2; margin-top: 20px;">
				<em>Начало</em> атаки WannaCry
			</div>
		</span></h2>
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>May 12, 2017</em></strong><br>
			<div style="font-size: 60%; line-height: 1.2; margin-top: 20px;">
				Microsoft публикуют патч для Windows XP
			</div>
		</span></h2>
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>May 12, Afternoon</em></strong><br>
			<div style="font-size: 60%; line-height: 1.2; margin-top: 20px;">
				Первый <em>kill-switch</em> домен активирован
			</div>
		</span></h2>
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>May 13, 2017</em></strong><br>
			<div style="font-size: 60%; line-height: 1.2; margin-top: 20px;">
				Создаётся <em>новая</em> версия WannaCry
			</div>
		</span></h2>
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>May 14, 2017</em></strong><br>
			<div style="font-size: 60%; line-height: 1.2; margin-top: 20px;">
				Второй kill-switch домен активирован
			</div>
		</span></h2>
	</section>




	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>Распространение</em></strong><br>
			<div style="font-size: 60%; line-height: 1.2; margin-top: 20px;">
				<ul>
					<li>Уязвимость EthernalBlue</li>
					<li>Бэкдор DoublePulsar</li>
				</ul>
			</div>
		</span></h2>
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>EthernalBlue</em></strong><br>
			<div style="font-size: 40%; line-height: 1.2; margin-top: 20px;">
				1. Уязвимость EthernalBlue &mdash; позволяет через уязвимый SMB <em>получать удаленный доступ к компьютеру</em> и незаметно <em>устанавливать на него программное обеспечение</em>
			</div>
		</span></h2>
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>SMB</em></strong><br>
			<div style="font-size: 40%; line-height: 1.2; margin-top: 20px;">
				<strong>SMB (<em>Server Message Block</em>)</strong> &mdash; сетевой протокол прикладного уровня для удалённого доступа к файлам, принтерам и другим сетевым ресурсам, а также для межпроцессного взаимодействия
				<p class="note">Критическая уязвимость MS17-010 в протоколе SMBv1</p>
			</div>
		</span></h2>
	</section>

	<section class="slide question">
		<div style="position:relative;width: 100%;height: 100%;margin: 0 auto;">
			<img class="place" src="meme.jpg" style="transform-origin: center;transform: translate(-50%,-54%) scale(0.6);">
		</div>
	</section>

	<section class="slide question">
		<iframe width="100%" height="90%" src="https://www.youtube.com/embed/6rrY0S8x3HQ" frameborder="0" allowfullscreen></iframe>
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>DoublePulsar</em></strong><br>
			<div style="font-size: 40%; line-height: 1.2; margin-top: 20px;">
				2. Бэкдор DoublePulsar &mdash; позволяет получать удаленный доступ и выполнять произвольный код на <em>предварительно скомпрометированной машине</em>
			</div>
		</span></h2>
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>Дано:</em></strong><br>
			<div style="font-size: 40%; line-height: 1.2; margin-top: 20px;">
				<ul>
					<li>Эксплойты, украденные Shadow Brokers</li>
					<li>Самописный сканнер сети на C/Python</li>
					<li>Linux сервер</li>
				</ul>
			</div>
		</span></h2>
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>Решение:</em></strong><br>
			<div style="font-size: 35%; line-height: 1.2; margin-top: 20px;">
				<ul>
					<li>Скрипт сканнера запускается на сервере</li>
					<li>Вбивается определенный диапазон IP или целая страна</li>
					<li>Скрипт сканирует диапазон на открытый 445 (и 139) порт</li>
					<li>В случае удачного обнаружения SMB сервиса, посылается эксплойт, вызывающий переполнение буфера</li>
					<li>Эксплойт закачивает файл и запускает его</li>
				</ul>
			</div>
		</span></h2>
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>Как работает?</em></strong><br>
			<div style="font-size: 40%; line-height: 1.2; margin-top: 20px;">
				<ul>
					<li>Распространяется как червь, заражает компьютер</li>
					<li>Функция «kill switch»</li>
					<li>Шифрует файлы 2048-битным RSA</li>
					<li>Устанавливает соединение с узлами сети Tor</li>
				</ul>
			</div>
		</span></h2>
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>Закрепление</em></strong><br>
			<div style="font-size: 40%; line-height: 1.3; margin-top: 20px;">
				1. <code>reg.exe</code> добавляет исполняемый файл <code>tasksche.exe</code> в автозапуск: <br>
				<br>
				<pre class="hljs cmd" style="font-size: 48%">
				<code>cmd.exe /c reg add hklm\software\microsoft\windows\currentversion\run \</code>
				<code>/v "abzyckxcqecwnu394" /t reg_sz /d "\"c:\intel\abzyckxcqecwnu394\tasksche.exe\""</code></pre>
			</div>
		</span></h2>
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>Закрепление</em></strong><br>
			<div style="font-size: 40%; line-height: 1.2; margin-top: 20px;">
				2. В систему дополнительно устанавливаются сервисы для обеспечения "выживаемости":
				<br>
				<br>
				<pre class="hljs sh" style="font-size: 48%">
				<code>c:\documents and settings\48=8ab@0b@\desktop\mapkep.bin</code>
				<code>c:\intel\abzyckxcqecwnu394\tasksche.exe</code></pre>
			</div>
		</span></h2>
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>Закрепление</em></strong><br>
			<div style="font-size: 40%; line-height: 1.2; margin-top: 20px;">
				3. <code>tasksche.exe</code> или сам вирус извлекает из себя и запускает файл <code>@wanadecryptor@.exe</code> множество раз в различные пользовательские папки и другие директории, содержащие файлы для зашифровывания <br>
				<p class="note">Далее происходит запуск большинства извлечённых компонентов</p>
			</div>
		</span></h2>
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>Закрепление</em></strong><br>
			<div style="font-size: 40%; line-height: 1.2; margin-top: 20px;">
				4. Процесс <code>@wanadecryptor@.exe</code> в свою очередь извлекает компоненты Tor-клиента и запускает его приложение <code style="font-size: 70%">c:\intel\abzyckxcqecwnu394\taskdata\tor\taskhsvc.exe</code>
			</div>
		</span></h2>
	</section>

	<section class="slide question">
		<code style="font-size: 100%;">
			iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea[.]com
		</code>
		<div style="position:relative;width: 100%;height: 100%;overflow: hidden;margin: 0 auto;">
			<img class="place" src="kill-switch.jpg" style="transform-origin: center;transform: translate(-50%,-65%) scale(1);">
		</div>
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>Что шифруется?</em></strong><br>
			<div style="font-size: 14%; line-height: 1.2; margin-top: 20px;">
				.der, .pfx, .key, .crt, .csr, .p12, .pem, .odt, .sxw, .stw, .3ds, .max, .3dm, .ods, .sxc, .stc, .dif, .slk, .wb2, .odp, .sxd, .std, .sxm, <em style="font-size: 300%">.sqlite3, .sqlitedb, .sql</em>, .accdb, .mdb, .dbf, .odb, .mdf, .ldf, <em style="font-size: 300%">.cpp, .pas, .asm, .cmd, .bat</em>, .vbs, .sch, .jsp, .php, .asp, .java, .jar, .class, <em style="font-size: 300%">.mp3, .wav, .swf, .fla</em>, .wmv, .mpg, .vob, .mpeg, .asf, <em style="font-size: 300%">.avi, .mov, .mp4, .mkv, .flv</em>, .wma, .mid, .m3u, .m4u, <em style="font-size: 300%">.svg, .psd, .tiff, .tif, .raw, .gif, .png, .bmp, .jpg, .jpeg, .iso, .backup, .zip, .rar, .tgz, .tar</em>, .bak, .ARC, .vmdk, .vdi, .sldm, .sldx, .sti, .sxi, .dwg, .pdf, .wk1, .wks, .rtf, .csv, .txt, .msg, .pst, .ppsx, .ppsm, .pps, .pot, .pptm, <em style="font-size: 300%">.pptx, .ppt</em>, .xltm, .xltx, .xlc, .xlm, .xlt, .xlw, .xlsb, .xlsm, <em style="font-size: 300%">.xlsx, .xls</em>, .dotm, .dot, .docm, <em style="font-size: 300%">.docx, .doc</em>
			</div>
		</span></h2>
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>Что дальше?</em></strong><br>
			<div style="font-size: 40%; line-height: 1.2; margin-top: 20px;">
				После заражения системы шифровальщик сканирует локальную сеть для поиска других уязвимых хостов, а также сканирует случайные диапазоны сети Интернет
				<p class="note">Минимальное время заражения системы после выставления в интернет 445 портом — 3 минуты</p>
			</div>
		</span></h2>
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>Защита</em></strong><br>
			<div style="font-size: 60%; line-height: 1.2; margin-top: 20px;">

			</div>
		</span></h2>
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>Защита</em></strong><br>
			<div style="font-size: 50%; line-height: 1.2; margin-top: 20px;">
				<ul>
					<li>Установка патчей, закрывающих описанные уязвимости</li>
					<li>Установка обновлений безопасности для операционных систем</li>
					<li>Правильная настройка МЭ</li>
				</ul>
			</div>
		</span></h2>
	</section>

	<section class="slide question">
		<h2><span style="font-size: 90%;">
			<strong><em>Защита</em></strong><br>
			<div style="font-size: 50%; line-height: 1.2; margin-top: 20px;">
				<ul>
					<li>Резервное копирование данных</li>
					<li>Отключение внешних соединений из Интернет по протоколу SMBv1</li>
					<li>Использование антивирусов и других средств защиты PC</li>
				</ul>
			</div>
		</span></h2>
	</section>

	<section class="slide">
		<h2 class="shout">Всем спасибо!</h2>
	</section>

	<div class="progress"></div>
	<script src="lib/shower/shower.min.js"></script>
	<script src="lib/hljs/highlight.pack.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>

</body>
</html>
